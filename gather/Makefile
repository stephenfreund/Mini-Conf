# make sprites rooms upload deploy for picking up new thumbs and new posters...

TEMP_DEPLOY_BRANCH = "temp-gh-posters"

# only *once*, unless poster sprites or background changes.
sprites:
	mkdir -p auto
	python3 create_user_poster_images.py

# only *once*, unless poster sprites or background changes.
default_sprites:
	mkdir -p auto
	python3 create_default_poster_images.py

# for any new posters
posters: 	 
	mkdir -p build
	python3 create_default_posters.py gather-assets/default-poster-gray.png

# # for any new posters
# titles:
# 	mkdir -p build
# 	python3 create_poster_titles.py 

# only once unless background, schedule, or sprites change
rooms: 	 
	mkdir -p build
	python3 create_poster_rooms.py
	python3 create_poster_room_maps.py
	echo "# auto-generated by 'python3 create_poster_pointpointers.py'" > ../sitedata/poster-gather-queries.yml
	python3 create_poster_pinpointers.py >> ../sitedata/poster-gather-queries.yml

directories:
	python3 create_poster_room_maps.py
	cp templates/directory.css build/directory.css
	cp ../static/css/Lato.css ../static/css/S6u9w4BMUTPHh50XSwiPHA.ttf ../static/css/S6uyw4BMUTPHjx4wWw.ttf build/

# as often as room changes...
upload:
	python3 upload_poster_rooms.py

# USE CAUTION: 
download:
	python3 get_gather_map.py room-fancy-1  > templates/fancy-1-new.json
	python3 get_gather_map.py room-fancy-2  > templates/fancy-2-new.json
	python3 get_gather_map.py room-fancy-3  > templates/fancy-3-new.json

# as often as you want...
signs: FAKE
	mkdir -p signs
	python3 create_signs.py

# for any new posters
papers:
	mkdir -p build
	cp -r paper-pdfs/* build/


FAKE:

# must build all items for build here, since that directory
# gets blown away afterwards...
deploy:  papers posters  directories
	-git branch -D gh-posters
	-git branch -D $(TEMP_DEPLOY_BRANCH)
	git checkout -b $(TEMP_DEPLOY_BRANCH)
	git add -f build
	git commit -m "Deploy on gh-posters" build/
	cd ..; git subtree split --prefix gather/build -b gh-posters; cd -
	git push --force origin gh-posters
	git checkout @{-1}
	@echo "Deployed to gh-posters ðŸš€"
